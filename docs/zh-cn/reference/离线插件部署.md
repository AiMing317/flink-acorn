部署离线版 flink 以及 flink-acorn的插件

###### 前提

- 安装java
- 安装maven
- 安装unzip

###### 下载完整对应的包

```bash
暂未整理好，未提供
```

####### 下载flink安装包
 
```bash
unzip flink-package.zip -d ./
# 解压安装包 创建软连接
sudo tar -vzxf flink-1.14.0-bin-scala_2.12.tgz -C /data/
sudo ln -s /data/flink-1.14.0 /opt/flink 

# 配置环境变量
sudo vim /etc/profile
# === sudo vim /etc/profile ===
export FLINK_HOME=/opt/flink
export PATH=$PATH:$FLINK_HOME/bin 
# === sudo vim /etc/profile ===
source /etc/profile

# 查看版本号
sudo chown -R dcloud:dcloud /data/flink-1.14.0
flink --version
```

####### 修改端口号

```bash
vim /opt/flink/conf/flink-conf.yaml

# --- vim $flink/conf/flink-conf.yaml ---

# 端口号，默认端口号 8081
rest.port: 30114

# 平行执行管道个数，默认1
taskmanager.numberOfTaskSlots: 20

# --- vim $flink/conf/flink-conf.yaml ---
```

####### 开启flink

> Note:
> 最好在$flink目录下执行启动命令，否则flink无法找到配置文件

```bash
cd /opt/flink
bash ./bin/start-cluster.sh
bash ./bin/stop-cluster.sh
```

####### 安装测试

```bash
flink run /opt/flink/examples/streaming/WordCount.jar
tail /opt/flink/log/flink-*-taskexecutor-*.out
```

###### 配置maven

```bash
mvn --version
unzip repository.zip -d ~/.m2/
cp settings.xml /opt/maven/conf/settings.xml
```

####### 支持mysql

```bash
cp ~/.m2/repository/org/apache/flink/flink-connector-jdbc_2.12/1.14.0/flink-connector-jdbc_2.12-1.14.0.jar /opt/flink/lib/ 

# 重启flink
cd /opt/flink
bash ./bin/stop-cluster.sh
bash ./bin/start-cluster.sh
```

####### 支持hive

```bash
# hive下的jars
scp dcloud@cdh-master:/opt/cloudera/parcels/CDH/jars/hive-*.jar /opt/flink/lib/ 
#cp /opt/cloudera/parcels/CDH/jars/hive-*.jar /opt/flink/lib/ 
# hadoop下的jars
scp dcloud@cdh-master:/opt/cloudera/parcels/CDH/jars/hadoop-*.jar /opt/flink/lib/ 
#cp /opt/cloudera/parcels/CDH/jars/hadoop-*.jar /opt/flink/lib/
# flink-connector-hive_xxx.jar
cp ~/.m2/repository/org/apache/flink/flink-connector-hive_2.12/1.14.0/flink-connector-hive_2.12-1.14.0.jar /opt/flink/lib/

# 修改配置
vim /opt/flink/conf/flink-conf.yaml

# --- sudo vim /opt/flink/conf/flink-conf.yaml ---
classloader.check-leaked-classloader: false
# --- sudo vim /opt/flink/conf/flink-conf.yaml ---

# 修改配置
vim /opt/flink/conf/hive-site.xml

# 重启flink
cd /opt/flink
sudo bash ./bin/stop-cluster.sh
sudo bash ./bin/start-cluster.sh
```

##### 启动插件

```bash
bash deploy.sh
```
