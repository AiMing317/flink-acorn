### 快速使用

!> 单节点为例

#### 插件安装

> 插件安装需要在服务器中进行 

#####  下载源码

```bash
git clone https://github.com/ispong/flink-acorn.git
```

#####  构建插件

```bash
bash build.sh
```

##### 配置插件

```bash
bash flink-acorn/build/acorn/bin/flink-acorn config
```

```yaml
server:
  port: 30155 # 插件访问端口号

acorn:
  plugin:
    key: acorn-key # 插件访问凭证
    flink-port: 8081 # 服务器安装flink的端口号
```

###### 启动插件

```bash
bash flink-acorn/build/acorn/bin/flink-acorn start
```

#### 插件使用

> 在spring项目中进行使用

###### 添加依赖

```xml
<dependency>
    <groupId>com.isxcode.acorn</groupId>
    <artifactId>acorn-common</artifactId>
    <version>1.1.2</version>
</dependency>
```

###### 修改配置文件

```yaml
acorn:
  worker:
    check-server: true
    workers:
      default:
        host: 192.168.66.66
        port: 30155
        key: acorn-key
```

###### 使用插件

```java
package com.isxcode.acorn.template.controller;

import com.isxcode.acorn.common.pojo.AcornResponse;
import com.isxcode.acorn.common.template.AcornTemplate;
import com.isxcode.acorn.template.pojo.DemoReq;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.web.bind.annotation.*;

@Slf4j
@RestController
@RequestMapping
@RequiredArgsConstructor
public class TemplateController {

    private final AcornTemplate acornTemplate;

    @GetMapping("/executeSql")
    public void executeSql() {

        String sql = " " +
            "  CREATE TABLE from_table ( " +
            "       username STRING, " +
            "       age INT" +
            "  ) WITH (" +
            "       'scan.startup.mode'='latest-offset'," +
            "       'properties.group.id'='test-consumer-group'," +
            "       'connector'='kafka'," +
            "       'topic'='acorn-input'," +
            "       'properties.zookeeper.connect'='127.0.0.1:2181'," +
            "       'properties.bootstrap.servers'='127.0.0.1:9092'," +
            "       'format'='csv'," +
            "       'csv.ignore-parse-errors' = 'true'" +
            "  ); " +
            "  CREATE TABLE to_table ( " +
            "        username STRING, " +
            "        age INT" +
            "  ) WITH (" +
            "       'scan.startup.mode'='latest-offset'," +
            "       'properties.group.id'='test-consumer-group'," +
            "       'connector'='kafka'," +
            "       'topic'='acorn-output'," +
            "       'properties.zookeeper.connect'='127.0.0.1:2181'," +
            "       'properties.bootstrap.servers'='127.0.0.1:9092'," +
            "       'format'='csv'," +
            "       'csv.ignore-parse-errors' = 'true'" +
            "  ); " +
            "  INSERT INTO to_table SELECT username,age FROM from_table WHERE age > 18;";

        AcornResponse acornResponse = acornTemplate.build()
            .executeId("custom_execute_id")
            .name("test_flink")
            .sql(sql)
            .execute();

        log.info("acornResponse {}", acornResponse.toString());
    }
}
```
